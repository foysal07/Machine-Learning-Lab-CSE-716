<!DOCTYPE html><html lang="en-US"><head ><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link type="text/css" media="all" href="https://www.learnopencv.com/wp-content/cache/autoptimize/css/autoptimize_ad7e5096a4f57e766069eb2747257e3b.css" rel="stylesheet" /><title>SVM using Scikit-Learn in Python | Learn OpenCV</title><meta name="description"  content="This post explains the implementation of Support Vector Machines (SVMs) using Scikit-Learn library in Python." /><meta name="keywords"  content="classification,python,scikit-learn,support vector machines,svm,machine learning,grid search,kernel trick,parameter tuning,support vector machine" /><link rel="canonical" href="https://www.learnopencv.com/svm-using-scikit-learn-in-python/" /><link rel="amphtml" href="https://www.learnopencv.com/svm-using-scikit-learn-in-python/amp/" /><link rel='dns-prefetch' href='//fonts.googleapis.com' /><link rel='dns-prefetch' href='//maxcdn.bootstrapcdn.com' /><link rel='dns-prefetch' href='//s.w.org' /><link rel="alternate" type="application/rss+xml" title="Learn OpenCV &raquo; Feed" href="https://www.learnopencv.com/feed/" /><link rel="alternate" type="application/rss+xml" title="Learn OpenCV &raquo; Comments Feed" href="https://www.learnopencv.com/comments/feed/" /><link rel="alternate" type="application/rss+xml" title="Learn OpenCV &raquo; SVM using Scikit-Learn in Python Comments Feed" href="https://www.learnopencv.com/svm-using-scikit-learn-in-python/feed/" /> <script type="text/javascript">window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.learnopencv.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.1.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);</script> <link rel='stylesheet' id='google-fonts-css'  href='//fonts.googleapis.com/css?family=Oswald%3A400%2C300%7COpen%3DSans%3A200%2C300%2C400%2C600%2C700&#038;ver=1.5' type='text/css' media='all' /><link rel='stylesheet' id='dashicons-css'  href='https://www.learnopencv.com/wp-includes/css/dashicons.min.css?ver=5.1.1' type='text/css' media='all' /><link rel='stylesheet' id='font-awesome-css'  href='https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css?ver=4.5.0' type='text/css' media='all' /> <script>if (document.location.protocol != "https:") {document.location = document.URL.replace(/^http:/i, "https:");}</script><script type='text/javascript' src='https://www.learnopencv.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/plugins/wp-hide-post/public/js/wp-hide-post-public.js?ver=2.0.10'></script> <!--[if lt IE 9]> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3'></script> <![endif]--> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/themes/epik/js/global.js?ver=1.0.0'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/plugins/wp-quicklatex/js/wp-quicklatex-frontend.js?ver=1.0'></script> <link rel='https://api.w.org/' href='https://www.learnopencv.com/wp-json/' /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.learnopencv.com/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.learnopencv.com/wp-includes/wlwmanifest.xml" /><link rel='prev' title='GOTURN : Deep Learning based Object Tracking' href='https://www.learnopencv.com/goturn-deep-learning-based-object-tracking/' /><link rel='next' title='Convolutional Neural Network based Image Colorization using OpenCV' href='https://www.learnopencv.com/convolutional-neural-network-based-image-colorization-using-opencv/' /><link rel='shortlink' href='https://www.learnopencv.com/?p=8837' /><link rel="alternate" type="application/json+oembed" href="https://www.learnopencv.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.learnopencv.com%2Fsvm-using-scikit-learn-in-python%2F" /><link rel="alternate" type="text/xml+oembed" href="https://www.learnopencv.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.learnopencv.com%2Fsvm-using-scikit-learn-in-python%2F&#038;format=xml" />  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-50426860-2"></script> <script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-50426860-2');</script>  <script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '193036094536652'); // Insert your pixel ID here.
fbq('track', 'PageView');</script> <noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=193036094536652&ev=PageView&noscript=1"
/></noscript><link rel="pingback" href="https://www.learnopencv.com/xmlrpc.php" /><link rel="icon" href="https://www.learnopencv.com/wp-content/uploads/2017/04/cropped-favicon-512x512-32x32.png" sizes="32x32" /><link rel="icon" href="https://www.learnopencv.com/wp-content/uploads/2017/04/cropped-favicon-512x512-192x192.png" sizes="192x192" /><link rel="apple-touch-icon-precomposed" href="https://www.learnopencv.com/wp-content/uploads/2017/04/cropped-favicon-512x512-180x180.png" /><meta name="msapplication-TileImage" content="https://www.learnopencv.com/wp-content/uploads/2017/04/cropped-favicon-512x512-270x270.png" /></head><body data-rsssl=1 class="post-template-default single single-post postid-8837 single-format-standard header-full-width content-sidebar" itemscope itemtype="https://schema.org/WebPage"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://www.learnopencv.com/">Learn OpenCV</a></p><p class="site-description" itemprop="description">OpenCV examples and tutorials ( C++ / Python )</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><div class="wrap"><ul id="menu-top-bar" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-754"><a href="https://www.learnopencv.com/" itemprop="url"><span itemprop="name">Home</span></a></li><li id="menu-item-753" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-753"><a href="https://www.learnopencv.com/about/" itemprop="url"><span itemprop="name">About</span></a></li><li id="menu-item-859" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-859"><a href="/computer-vision-resources" itemprop="url"><span itemprop="name">Resources</span></a></li><li id="menu-item-4009" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4009"><a href="https://www.learnopencv.com/computer-vision-machine-learning-artificial-intelligence-consulting/" itemprop="url"><span itemprop="name">AI Consulting</span></a></li><li id="menu-item-4153" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4153"><a href="http://courses.learnopencv.com" itemprop="url"><span itemprop="name">Courses</span></a></li></ul></div></nav></div></header><div class="site-inner"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-8837 post type-post status-publish format-standard has-post-thumbnail category-machine-learning tag-classification tag-grid-search tag-kernel-trick tag-parameter-tuning tag-python tag-scikit-learn tag-support-vector-machine tag-svm entry" itemscope itemtype="https://schema.org/CreativeWork"><header class="entry-header"><h1 class="entry-title" itemprop="headline">SVM using Scikit-Learn in Python</h1><p class="entry-meta"><time class="entry-time" itemprop="datePublished" datetime="2018-07-27T06:16:50-07:00">July 27, 2018</time> By <span class="entry-author" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://www.learnopencv.com/author/krshrimali/" class="entry-author-link" itemprop="url" rel="author"><span class="entry-author-name" itemprop="name">Kushashwa Ravi Shrimali</span></a></span> <span class="entry-comments-link"><a href="https://www.learnopencv.com/svm-using-scikit-learn-in-python/#disqus_thread"><span class="dsq-postid" data-dsqidentifier="8837 https://www.learnopencv.com/?p=8837">3 Comments</span></a></span></p></header><div class="entry-content" itemprop="text"><p>This post explains the implementation of Support Vector Machines (SVMs) using Scikit-Learn library in Python. We had discussed the math-less details of <a href="/support-vector-machines-svm/">SVMs</a> in the <a href="/support-vector-machines-svm/">earlier post</a>.</p><p>In this post, we will show the working of SVMs for three different type of datasets:</p><ol><li><strong>Linearly Separable data with no noise</strong></li><li><strong>Linearly Separable data with added noise</strong></li><li><strong>Non-linear separable data with added noise</strong></li></ol><h2>Prerequisites</h2><p>Before we begin, we need to install <strong>sklearn</strong> and <strong>matplotlib</strong> modules. This can be done using <a href="https://pip.pypa.io/en/stable/installing/">pip</a>.</p><pre class="brush: bash; title: ; notranslate" title="">pip install -U scikit-learn
pip install -U matplotlib
</pre><p>We first import <strong>matplotlib.pyplot</strong> for plotting graphs. We also need <strong>svm</strong> imported from <strong>sklearn</strong>. Finally, from <strong>sklearn.model_selection</strong> we need <strong>train_test_split</strong> to randomly split data into training and test sets, and <strong>GridSearchCV</strong> for searching the best parameter for our classifier. The code below shows the imports.</p><pre class="brush: python; title: ; notranslate" title=""> 
import sys, os
import matplotlib.pyplot as plt
from sklearn import svm
from sklearn.model_selection import train_test_split, GridSearchCV
</pre><h2>Linearly separable data with no noise</h2><p>Let&#8217;s first look at the simplest cases where the data is cleanly separable linearly. In the 2D case, it simply means we can find a line that separates the data. In the 3D case, it will be a plane. For higher dimensions, it is simply a plane.</p><figure id="attachment_9084" aria-describedby="caption-attachment-9084" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linearly-separable-data.png"><img class="wp-image-9084 size-large" src="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linearly-separable-data-1024x341.png" alt="Linearly separable data" width="1024" height="341" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linearly-separable-data-1024x341.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linearly-separable-data-300x100.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linearly-separable-data-768x256.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linearly-separable-data.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9084" class="wp-caption-text">Figure 1. Linearly separable data. The dataset is randomly split into 80% training and 20% test.</figcaption></figure><p>Let&#8217;s see how we can use a simple binary SVM classifier based on the data above.</p><div class="download-code"><strong> Download Code</strong><br /> To easily follow along this tutorial, please download code by clicking on the button below. It&#8217;s FREE!</p><div style="text-align: center"><a class="button small loblue" style="text-decoration: none" href="https://bigvisionllc.leadpages.net/leadbox/143948b73f72a2%3A173c9390c346dc/5649050225344512/" target="_blank" rel="noopener">Download Code </a></div></div><p>If you have downloaded the code, here are the steps for building a binary classifier</p><ol><li><strong>Prepare data</strong>: We read the data from the files <em>points_class_0.txt</em> and <em>points_class_1.txt</em>. These files simply have x and y coordinates of points &#8212; one per line. The points in<em> points_class_0.txt</em> are assinged the label 0 and the points in <em> points_class_1.txt</em> are assigned the label 1. The dataset is then split into training (80%) and test (20%) sets. This dataset is shown in Figure 1.<pre class="brush: python; first-line: 12; title: ; notranslate" title=""> 
# Read data
x, labels = read_data(&quot;points_class_0.txt&quot;, &quot;points_class_1.txt&quot;)

# Split data to train and test on 80-20 ratio
X_train, X_test, y_train, y_test = train_test_split(x, labels, test_size = 0.2, random_state=0)

# Plot traning and test data
plot_data(X_train, y_train, X_test, y_test)
</pre></li><li><strong>Create an instance of a Linear SVM classifier</strong>: Next we create an instance of the Linear SVM classifier from <strong>scikit-learn</strong>. We use the default parameters because the problem is easy to solve and we expect the default parameters to work just fine. We only specify the SVM be linear.<pre class="brush: python; first-line: 20; title: ; notranslate" title=""># Create a linear SVM classifier 
clf = svm.SVC(kernel='linear')
</pre></li><li><strong>Train a Linear SVM classifier</strong>: Next we train a Linear SVM. In other words, based on the training data, we find the line that separates the two classes. This is simply done using the fit method of the SVM class.<pre class="brush: python; first-line: 23; title: ; notranslate" title=""># Train classifier 
clf.fit(X_train, y_train)

# Plot decision function on training and test data
plot_decision_function(X_train, y_train, X_test, y_test, clf)
</pre><p>Next, we plot the decision boundary and support vectors. The decision boundary is estimated based on only the traning data. Given a new data point (say from the test set), we simply need to check which side of the line the point lies to classify it as 0 ( red ) or 1 (blue).</p><p><figure id="attachment_9085" aria-describedby="caption-attachment-9085" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-boundary-margins-support-vector.png"><img class="wp-image-9085 size-large" src="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-boundary-margins-support-vector-1024x512.png" alt="Decision boundary, margins and support vectors" width="1024" height="512" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-boundary-margins-support-vector-1024x512.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-boundary-margins-support-vector-300x150.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-boundary-margins-support-vector-768x384.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-boundary-margins-support-vector.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9085" class="wp-caption-text">Figure 2: Decision boundary (solid line) and support vectors (black dots).</figcaption></figure></li><li><strong>Test a Linear SVM classifier</strong>:<br /> To predict the class of a new point ( or points ) we can simply use the <strong>predict</strong> method of the SVM class. To obtain the accuracy on the test set, we can use the <strong>score</strong> method.</p><pre class="brush: python; title: ; notranslate" title=""># Make predictions on unseen test data
clf_predictions = clf.predict(X_test)
print(&quot;Accuracy: {}%&quot;.format(clf.score(X_test, y_test) * 100 ))
</pre><p>In this easy example, the accuracy is 100%.</li></ol><h2>Linearly separable data with noise</h2><p>Let&#8217;s look at a slightly more complicated case shown in Figure 3 where it is not possible to linearly separate the data, but a linear classifier still makes sense. Note that no matter what you do some red points and some blue points will be on the wrong side of the line.</p><figure id="attachment_9087" aria-describedby="caption-attachment-9087" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linear-data-with-noise.png"><img class="size-large wp-image-9087" src="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linear-data-with-noise-1024x341.png" alt="SVM Linear Data with Noise" width="1024" height="341" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linear-data-with-noise-1024x341.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linear-data-with-noise-300x100.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linear-data-with-noise-768x256.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-linear-data-with-noise.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9087" class="wp-caption-text">Figure 3: SVM Linear Data with Noise</figcaption></figure><p>The question now is which line to choose? SVM provides you with parameter called C that you can set while training. In scikit-learn, this can be done using the following lines of code</p><pre class="brush: python; title: ; notranslate" title=""> 
# Create a linear SVM classifier with C = 1
clf = svm.SVC(kernel='linear', C=1)
</pre><p>If you set C to be a low value (say 1), the SVM classifier will choose a large margin decision boundary at the expense of larger number of misclassifications. When C is set to a high value (say 100), the classifier will choose a low margin decision boundary and try to minimize the misclassifications. This is shown in Figure 4. The margin is the shown using dotted lines &#8212; the larger the space between the dotted lines, the larger is the margin.</p><figure id="attachment_9086" aria-describedby="caption-attachment-9086" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-parameter-c-example.png"><img class="size-large wp-image-9086" src="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-parameter-c-example-1024x573.png" alt="SVM Parameter C" width="1024" height="573" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-parameter-c-example-1024x573.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-parameter-c-example-300x168.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-parameter-c-example-768x430.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-parameter-c-example.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9086" class="wp-caption-text">Figure 4: SVM Parameter C</figcaption></figure><p>You may be tempted to ask which value of C is better. The answer depends on how much noise you think there is in your data. If you think the data is very noisy, you want C to be small. On the other hand, if you think the data is less noisy, you should choose C to be large.</p><h2>Non-Linearly separable data with noise</h2><p>Finally, let&#8217;s look at data that is impossible to partition using a line.</p><figure id="attachment_9088" aria-describedby="caption-attachment-9088" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/non-linear-separable-data.png"><img class="size-large wp-image-9088" src="https://www.learnopencv.com/wp-content/uploads/2018/07/non-linear-separable-data-1024x341.png" alt="Non-Linear SVM Data. " width="1024" height="341" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/non-linear-separable-data-1024x341.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/non-linear-separable-data-300x100.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/non-linear-separable-data-768x256.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/non-linear-separable-data.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9088" class="wp-caption-text">Figure 5: Non-Linear SVM Data.</figcaption></figure><p>Is SVM useless in such cases? Fortunately, the answer is no. We can use the <a href="/support-vector-machines-svm">Kernel Trick explained in our previous article</a>. In scikit-learn we can specify the <strong>kernel</strong> type while instantiating the SVM class.</p><pre class="brush: python; title: ; notranslate" title=""># Create SVM classifier based on RBF kernel. 
clf = svm.SVC(kernel='rbf', C = 10.0, gamma=0.1)
</pre><p>In the above example, we are using the Radial Basis Fucttion expalined in our previous post with parameter <strong>gamma</strong> set to 0.1. As you can see in Figure 6, the SVM with an RBF kernel produces a ring shaped decision boundary instead of a line.</p><figure id="attachment_9089" aria-describedby="caption-attachment-9089" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear.png"><img class="size-large wp-image-9089" src="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-1024x512.png" alt="SVM with RBF Kernel" width="1024" height="512" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-1024x512.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-300x150.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-768x384.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9089" class="wp-caption-text">Figure 6: SVM with RBF Kernel</figcaption></figure><p>Looking at Figure 6 you may be tempted to think that using some other value for C and gamma, we may be able to come up with a better decision boundary. Your intuition is right. To find the best parameters, we need to do a parameter sweep by changing values of C and gamma and picking the one that works best. Let&#8217;s see how parameters tuning in done using GridSearchCV.</p><h2>Parameter Tuning using GridSearchCV</h2><p>The module <strong>sklearn.model_selection</strong> allows us to do a grid search over parameters using <strong>GridSearchCV</strong>. All we need to do is specify which parameters we want to vary and by what value. In the following example, the parameters C and gamma are varied. Every combination of C and gamma is tried and the best one is chosen based. The best estimator can be accessed using <strong>clf.best_estimator_</strong>.</p><pre class="brush: python; first-line: 36; title: ; notranslate" title=""> 
# Grid Search
# Parameter Grid
param_grid = {'C': [0.1, 1, 10, 100], 'gamma': [1, 0.1, 0.01, 0.001, 0.00001, 10]}

# Make grid search classifier
clf_grid = GridSearchCV(svm.SVC(), param_grid, verbose=1)

# Train the classifier
clf_grid.fit(X_train, y_train)

# clf = grid.best_estimator_()
print(&quot;Best Parameters:\n&quot;, clf_grid.best_params_)
print(&quot;Best Estimators:\n&quot;, clf_grid.best_estimator_)
</pre><p>By default, GridSearchCV performs 3-fold cross-validation. In other words, it divides the data into 3 parts and uses two parts for training, and one part for determining accuracy. This is done three times so each of the three parts is in the training set twice and validation set once. The accuracy for a given C and gamma is the average accuracy during 3-fold cross-validation.</p><p>The best parameters ( C = 1 and gamma = 0.01 ) of classifier shown in Figure 7 were found using GridSearchCV. Our intuition also confirms this shape of the decision boundary looks better than the one manually chosen.</p><figure id="attachment_9090" aria-describedby="caption-attachment-9090" style="width: 1024px" class="wp-caption alignleft"><a href="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-gridsearch.png"><img class="size-large wp-image-9090" src="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-gridsearch-1024x512.png" alt="Parameter search using GridSearchCV" width="1024" height="512" srcset="https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-gridsearch-1024x512.png 1024w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-gridsearch-300x150.png 300w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-gridsearch-768x384.png 768w, https://www.learnopencv.com/wp-content/uploads/2018/07/svm-decision-function-non-linear-gridsearch.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-9090" class="wp-caption-text">Figure 7: Parameter search using GridSearchCV</figcaption></figure><h2 id="download">Subscribe &amp; Download Code</h2><p>If you liked this article and would like to download code (C++ and Python) and example images used in this post, please <a href="https://bigvisionllc.leadpages.net/leadbox/143948b73f72a2%3A173c9390c346dc/5649050225344512/" target="_blank" rel="noopener">subscribe</a> to our newsletter. You will also receive a free <a href="https://bigvisionllc.leadpages.net/leadbox/143948b73f72a2%3A173c9390c346dc/5649050225344512/" target="_blank" rel="noopener">Computer Vision Resource</a> Guide. In our newsletter, we share OpenCV tutorials and examples written in C++/Python, and Computer Vision and Machine Learning algorithms and news.</p><p><a href="https://bigvisionllc.leadpages.net/leadbox/143948b73f72a2%3A173c9390c346dc/5649050225344512/" target="_blank" rel="noopener">Subscribe Now</a></p></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Filed Under: <a href="https://www.learnopencv.com/category/machine-learning/" rel="category tag">Machine Learning</a></span> <span class="entry-tags">Tagged With: <a href="https://www.learnopencv.com/tag/classification/" rel="tag">classification</a>, <a href="https://www.learnopencv.com/tag/grid-search/" rel="tag">Grid Search</a>, <a href="https://www.learnopencv.com/tag/kernel-trick/" rel="tag">Kernel Trick</a>, <a href="https://www.learnopencv.com/tag/parameter-tuning/" rel="tag">Parameter Tuning</a>, <a href="https://www.learnopencv.com/tag/python/" rel="tag">Python</a>, <a href="https://www.learnopencv.com/tag/scikit-learn/" rel="tag">scikit-learn</a>, <a href="https://www.learnopencv.com/tag/support-vector-machine/" rel="tag">Support Vector Machine</a>, <a href="https://www.learnopencv.com/tag/svm/" rel="tag">SVM</a></span></p></footer></article><div id="disqus_thread"><div id="dcl_btn_container"> <button id='dcl_comment_btn' class=""> Load Comments </button></div></div></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><section id="search-5" class="widget widget_search"><div class="widget-wrap"><form class="search-form" itemprop="potentialAction" itemscope itemtype="https://schema.org/SearchAction" method="get" action="https://www.learnopencv.com/" role="search"><label class="search-form-label screen-reader-text" for="searchform-5ca1cb0c6433b5.50186926">Search this website</label><input class="search-form-input" type="search" itemprop="query-input" name="s" id="searchform-5ca1cb0c6433b5.50186926" placeholder="Search this website"><input class="search-form-submit" type="submit" value="Search"><meta itemprop="target" content="https://www.learnopencv.com/?s={s}"></form></div></section><section id="custom_html-9" class="widget_text widget widget_custom_html"><div class="widget_text widget-wrap"><h4 class="widget-title widgettitle">Join Course</h4><div class="textwidget custom-html-widget"><a href="https://courses.learnopencv.com/p/computer-vision-for-faces"> <img alt="Computer Vision for Faces" src="/wp-content/uploads/2018/09/join-computer-vision-for-faces.png"/> </a></div></div></section><section id="custom_html-7" class="widget_text widget widget_custom_html"><div class="widget_text widget-wrap"><h4 class="widget-title widgettitle">Resources</h4><div class="textwidget custom-html-widget"><a href="https://bigvisionllc.lpages.co/leadbox/143044973f72a2%3A173c9390c346dc/5720147234914304/" target="_blank" style="background: #4FAEFD; color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: 
rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;">Download Code (C++ / Python)</a></div></div></section><section id="text-8" class="widget widget_text"><div class="widget-wrap"><h4 class="widget-title widgettitle">Disclaimer</h4><div class="textwidget"><p>This site is not affiliated with OpenCV.org</p></div></div></section><section id="user-profile-4" class="widget user-profile"><div class="widget-wrap"><p><span class="alignleft"><img alt='' src='https://secure.gravatar.com/avatar/708995cd13fb5756f6bc418aecb23b78?s=125&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/708995cd13fb5756f6bc418aecb23b78?s=250&#038;d=mm&#038;r=g 2x' class='avatar avatar-125 photo' height='125' width='125' /></span>I am an entrepreneur with a love for Computer Vision and Machine Learning with a dozen years of experience (and a Ph.D.) in the field.</p><p>In 2007, right after finishing my Ph.D.,  I co-founded TAAZ Inc. with my advisor Dr. David Kriegman and Kevin Barnes. The scalability, and robustness of our computer vision and machine learning algorithms have been put to rigorous test by more than 100M users who have tried our products. <a class="pagelink" href="https://www.learnopencv.com/about/">Read More…</a></p></div></section><section id="recent-posts-6" class="widget widget_recent_entries"><div class="widget-wrap"><h4 class="widget-title widgettitle">Recent Posts</h4><ul><li> <a href="https://www.learnopencv.com/hough-transform-with-opencv-c-python/">Hough Transform with OpenCV (C++/Python)</a></li><li> <a href="https://www.learnopencv.com/xeus-cling-run-c-code-in-jupyter-notebook/">Xeus-Cling: Run C++ code in Jupyter Notebook</a></li><li> <a href="https://www.learnopencv.com/pose-detection-comparison-wrnchai-vs-openpose/">Pose Detection comparison : wrnchAI vs OpenPose</a></li><li> <a href="https://www.learnopencv.com/age-gender-classification-using-opencv-deep-learning-c-python/">Gender &#038; Age Classification using OpenCV Deep Learning ( C++/Python )</a></li><li> <a href="https://www.learnopencv.com/invisibility-cloak-using-color-detection-and-segmentation-with-opencv/">Invisibility Cloak using Color Detection and Segmentation with OpenCV</a></li></ul></div></section></aside></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="wrap"><nav class="nav-footer"></nav><p>Copyright &#x000A9;&nbsp;2019 &middot; Big Vision LLC</p></div></footer></div><script data-leadbox="143948b73f72a2:173c9390c346dc" data-url="https://bigvisionllc.lpages.co/leadbox/143948b73f72a2%3A173c9390c346dc/5649050225344512/" data-config="%7B%7D" type="text/javascript" src="https://bigvisionllc.lpages.co/leadbox-1538148152.js"></script> <script data-leadbox="143044973f72a2:173c9390c346dc" data-url="https://bigvisionllc.lpages.co/leadbox/143044973f72a2%3A173c9390c346dc/5720147234914304/" data-config="%7B%7D" type="text/javascript" src="https://bigvisionllc.lpages.co/leadbox-1538148152.js"></script> <script src="//rum-static.pingdom.net/pa-5bb69d586cee870016000122.js" async></script><script>if (document.location.protocol != "https:") {document.location = document.URL.replace(/^http:/i, "https:");}</script><script type='text/javascript' src='https://www.learnopencv.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0.9b'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.9b'></script> <script type='text/javascript'>(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://www.learnopencv.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://www.learnopencv.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}</script> <script type='text/javascript'>var countVars = {"disqusShortname":"learnopencv"};
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"8837 https:\/\/www.learnopencv.com\/?p=8837","disqusShortname":"learnopencv","disqusTitle":"SVM using Scikit-Learn in Python","disqusUrl":"https:\/\/www.learnopencv.com\/svm-using-scikit-learn-in-python\/","postId":"8837"};
var dclCustomVars = {"dcl_progress_text":"Loading..."};</script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/plugins/disqus-conditional-load/assets/js/public/embed-click.min.js?ver=11.0.1'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-includes/js/hoverIntent.min.js?ver=1.8.1'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.8.1'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.8.1'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-content/themes/epik/js/fadeup.js?ver=1.0.0'></script> <script type='text/javascript' src='https://www.learnopencv.com/wp-includes/js/wp-embed.min.js?ver=5.1.1'></script> </body></html>
<!-- Dynamic page generated in 0.414 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2019-04-01 01:25:48 -->

<!-- super cache -->